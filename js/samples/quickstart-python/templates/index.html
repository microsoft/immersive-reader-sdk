<!-- Copyright (c) Microsoft Corporation. All rights reserved.
     Licensed under the MIT License. -->

<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <title>Immersive Reader Python Quickstart</title>

        <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
        <script type='text/javascript' src='https://ircdname.azureedge.net/immersivereadersdk/immersive-reader-sdk.1.2.0.js'></script>
        <script type='text/javascript' src="{{url_for('static', filename='helpers.js')}}"></script>

        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous"/>
        <style type="text/css">
            .immersive-reader-button {
                background-color: white;
                margin-top: 5px;
                border: 1px solid black;
                float: right;
            }

            nav {
                margin-top: 10px;
                margin-left: auto;
                margin-right: auto;
                text-align: center;
            }
        </style>
    </head>
    <body>
        <nav>
            <a href='/'>Home </a>
            <a href='/options'>Options </a>
        </nav>
        <div class="container">
            <button class="immersive-reader-button" data-button-style="iconAndText" data-locale="en"></button>

            <h1 id="ir-title">About Immersive Reader</h1>
            <div id="ir-content" lang="en-us">
                <p>
                    Immersive Reader is a tool that implements proven techniques to improve reading comprehension for emerging readers, language learners, and people with learning differences.
                    The Immersive Reader is designed to make reading more accessible for everyone. The Immersive Reader
                    <ul>
                        <li>
                            Shows content in a minimal reading view
                        </li>
                        <li>
                            Displays pictures of commonly used words
                        </li>
                        <li>
                            Highlights nouns, verbs, adjectives, and adverbs
                        </li>
                        <li>
                            Reads your content out loud to you
                        </li>
                        <li>
                            Translates your content into another language
                        </li>
                        <li>
                            Breaks down words into syllables
                        </li>
                    </ul>
                </p>
                <h3>
                    The Immersive Reader is available in many languages.
                </h3>
                <p lang="es-es">
                    El Lector inmersivo está disponible en varios idiomas.
                </p>
                <p lang="zh-cn">
                    沉浸式阅读器支持许多语言
                </p>
                <p lang="de-de">
                    Der plastische Reader ist in vielen Sprachen verfügbar.
                </p>
                <p lang="ar-eg" dir="rtl" style="text-align:right">
                    يتوفر \"القارئ الشامل\" في العديد من اللغات.
                </p>
            </div>
        </div>

        <script type="text/javascript">

            $(".immersive-reader-button").click(function () {
                handleLaunchImmersiveReader();
            });

            // The GetToken API endpoint should be secured behind some form of authentication (for example, OAuth) to prevent unauthorized users from obtaining tokens to use against your Immersive Reader service and billing; that work is beyond the scope of this sample.            
            function handleLaunchImmersiveReader() {
                getTokenAndSubdomainAsync()
                    .then(function (response) {
                        const token = response["token"];
                        const subdomain = response["subdomain"];

                        // Learn more about chunk usage and supported MIME types https://docs.microsoft.com/azure/cognitive-services/immersive-reader/reference#chunk
                        const data = {
                            title: $("#ir-title").text(),
                            chunks: [{
                                content: $("#ir-content").html(),
                                mimeType: "text/html"
                            }]
                        };

                        // Learn more about options https://docs.microsoft.com/azure/cognitive-services/immersive-reader/reference#options
                        const options = {
                            "onExit": exitCallback,
                            "uiZIndex": 2000
                        };

                        ImmersiveReader.launchAsync(token, subdomain, data, options)
                            .catch(error => handleError(error, 'launch'));
                    })
                    .catch(error => handleError(error, 'token'));
            }

            function exitCallback() {
                console.log("This is the callback function. It is executed when the Immersive Reader closes.");
            }
        </script>
    </body>
</html>